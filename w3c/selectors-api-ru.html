<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html lang="ru">
  <meta content="text/html;charset=UTF-8" http-equiv=Content-Type>
  <title>Selectors API Level 1 — W3C</title>

  <style type="text/css">
	pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
	pre.idl :link, pre.idl :visited { color:inherit; background:transparent }

	div.example { border-left:double; padding-left:1em }
	dfn { font-style:normal; font-weight:bolder }
	em.ct { font-style:normal; font-weight:normal; font-variant:small-caps }
	p.note {  margin-left:2em; color:green; font-style:italic; font-weight:bold }
	p.note:before { content:"Заметка: " }
	.issue { padding:.5em; border:solid red }
	.issue:before { content:"Issue: " }
	code { color:#FF4500; }
	code :link, code :visited { color:inherit }
	.translator { border: solid 2px black; background-color: #EEE9E9; padding: 5px; font-size: 15px; margin-bottom: 20px; }
	</style>
  <link href="https://www.w3.org/StyleSheets/TR/W3C-REC" rel=stylesheet
   type="text/css">

 <body>
  <!-- Yandex.Metrika counter --> <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter36816840 = new Ya.Metrika({ id:36816840, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/36816840" style="position:absolute; left:-9999px;" alt="" /></div></noscript> <!-- /Yandex.Metrika counter -->

<p class="translator">
Этот документ является неофициальным переводом исходной английской версии <a href="https://www.w3.org/TR/selectors-api/" target="_blank" rel="nofollow">Selectors API Level 1</a>. Обратите внимание на то, что оригинальная версия документа существует только на английском языке. Данный перевод может содержать неточности и ошибки. Перевод выполнил <a href="http://kirilljohnson.com/" target="_blank">Kirill Johnson</a>, 2016.</p>

  <div class=head>
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="https://www.w3.org/Icons/w3c_home" width=72></a>

   <h1 id=title>Selectors API Level 1</h1>

   <h2 class="no-num no-toc" id=W3C-doctype>Рекомендация W3C от 21 февраля 2013</h2>

   <dl>
    <dt>Эта версия:

    <dd><a
     href="http://www.w3.org/TR/2013/REC-selectors-api-20130221/">http://www.w3.org/TR/2013/REC-selectors-api-20130221/</a>

    <dt>Последняя версия:

    <dd><a
     href="http://www.w3.org/TR/selectors-api/">http://www.w3.org/TR/selectors-api/</a>

    <dt>Предыдущие версии:

    <dd><a
     href="http://www.w3.org/TR/2012/PR-selectors-api-20121213/">http://www.w3.org/TR/2012/PR-selectors-api-20121213/</a>

    <dd><a
     href="http://www.w3.org/TR/2012/WD-selectors-api-20120628/">http://www.w3.org/TR/2012/WD-selectors-api-20120628/</a>

    <dd><a
     href="http://www.w3.org/TR/2009/CR-selectors-api-20091222/">http://www.w3.org/TR/2009/CR-selectors-api-20091222/</a>

    <dd><a
     href="http://www.w3.org/TR/2008/WD-selectors-api-20081114/">http://www.w3.org/TR/2008/WD-selectors-api-20081114/</a>

    <dd><a
     href="http://www.w3.org/TR/2007/WD-selectors-api-20071221/">http://www.w3.org/TR/2007/WD-selectors-api-20071221/</a>

    <dd><a
     href="http://www.w3.org/TR/2007/WD-selectors-api-20071019/">http://www.w3.org/TR/2007/WD-selectors-api-20071019/</a>

    <dd><a
     href="http://www.w3.org/TR/2006/WD-selectors-api-20060926/">http://www.w3.org/TR/2006/WD-selectors-api-20060926/</a>

    <dd><a
     href="http://www.w3.org/TR/2006/WD-selectors-api-20060525/">http://www.w3.org/TR/2006/WD-selectors-api-20060525/</a>

    <dt>Редакторы:

    <dd><a href="http://annevankesteren.nl/" target="_blank" rel="nofollow">Anne van Kesteren</a> (<a
     href="http://www.mozilla.org/">Mozilla</a>) &lt;<a
     href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>&gt;

    <dd><a href="http://lachy.id.au/" target="_blank" rel="nofollow">Lachlan Hunt</a> &lt;<a
     href="mailto:lachlan.hunt@lachy.id.au">lachlan.hunt@lachy.id.au</a>&gt;
   </dl>

   <p>Смотрите <a
    href="http://dev.w3.org/2006/webapi/selectors-api/errata/errata-l1.html"><strong>страницу исправлений</strong></a>
    для этого документа, которая может содержать некоторые нормативные изменения.

   <p>Также смотрите <a
    href="http://www.w3.org/2003/03/Translations/byTechnology?technology=selectors-api"><strong>переводы</strong></a>.

   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    © 2006-2013 <a href="http://www.w3.org/"><acronym
    title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a
    href="http://www.csail.mit.edu/"><acronym
    title="Massachusetts Institute of Technology">MIT</acronym></a>, <a
    href="http://www.ercim.eu/"><acronym
    title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
    <a href="http://www.keio.ac.jp/">Keio</a>, <a
    href="http://ev.buaa.edu.cn/">Beihang</a>), все права защищены. W3C придерживается правил <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">ответственности</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">торговой марки</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">использования документов</a>.
  </div>

  <hr>

  <h2 class="no-num no-toc" id=abstract>Аннотация</h2>

  <p>Селекторы, которые широко используются в CSS, являются паттернами которые соответствуют
   элементам в древовидной структуре <a href="#SELECT"
   rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a><a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{CSS21}}--></a>. Спецификация Selectors API
   определяет методы получения нод <a
   href="#element"><code>Element</code></a> из <abbr
   title="Document Object Model">DOM</abbr> сопоставлением группы
   селекторов. Часто бывает желательным выполнять операции DOM на определенном
   наборе элементов в документе. Эти методы упрощают процесс
   приобретения определенных элементов, особенно по сравнению с более многословными
   техниками, определенными и используемыми в прошлом.

  <h2 class="no-num no-toc" id=sotd>Статус этого документа</h2>

  <p><em>Этот раздел описывает статус данного документа на момент его публикации. Другие документы могут заменять этот документ. Со списком текущих публикаций W3C и последней ревизией этого технического доклада можно ознакомиться в <a href="http://www.w3.org/TR/">индексе технических отчетов W3C</a>, http://www.w3.org/TR/.</em>

  <p><a href="http://www.w3.org/2008/webapps/">Рабочая группа веб-приложений (WebApps)</a> разработала комплексный <a
   href="http://dev.w3.org/2006/webapi/selectors-api-testsuite/">набор тестов Selectors
   API</a> и показала интероперабельность возможностей
   среди реализаций. Пожалуйста, посмотрите <a
   href="http://dev.w3.org/2006/webapi/selectors-api-testsuite/level1-baseline-report.html"
   title="Selectors API Implementation Report: Baseline Tests">отчет о реализации</a> Рабочей группы.

  <p>Пожалуйста, отправляйте комментарии об этом документе на <a
   href="mailto:public-webapps@w3.org">public-webapps@w3.org</a> (<a
   href="http://lists.w3.org/Archives/Public/public-webapps/" rel="nofollow">публичный архив</a>) с пометкой <kbd>[selectors-api]</kbd> в теме. (Заметьте, что до середины 2008 использовался другой архивный лист, так что некоторые старые сообщения <a
   href="http://lists.w3.org/Archives/Public/public-webapi/" rel="nofollow">архивированы здесь</a>).

  <p>Этот документ был разработан <a
   href="http://www.w3.org/2008/webapps/">Рабочей группой веб-приложений</a>.
   Полный <a
   href="http://dev.w3.org/cvsweb/2006/webapi/selectors-api/">список изменений</a> этого документа доступен.

  <p>Этот документ был рассмотрен членами W3C, разработчиками программного обеспечения, а также другими группами W3C и заинтересованными лицами, и одобрен Директором в качестве Рекомендации W3C. Это стабильный документ и может быть использован в качестве справочного материала или цитироваться из другого документа. Цель W3C в создании Рекомендации заключается в привлечении внимания к спецификации и способствовании ее широкому распространению. Это повышает функциональность и совместимость Сети.

  <p>Этот документ был подготовлен группой, работающей под <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/">Патентной Политикой W3C от 5 февраля 2004</a>. W3C поддерживает <a
   href="http://www.w3.org/2004/01/pp-impl/42538/status"
   rel=disclosure>публичный список открытых патентов</a>, сделанных в связи с результатами деятельности группы; эта страница также включает в себя инструкции по раскрытию патента. Человек, который имеет фактическое знание патента, который удовлетворяет <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">основным требованиям</a>, должен раскрывать информацию в соответствии c <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">разделом 6 патентной политики W3C</a>.

  <h2 class="no-num no-toc" id=toc>Содержание</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#introduction"><span class=secno>1. </span>Введение</a>
    <ul class=toc>
     <li><a href="#examples"><span class=secno>1.1. </span>Примеры</a>
    </ul>

   <li><a href="#conformance"><span class=secno>2. </span>Требования к соответствию</a>
    <ul class=toc>
     <li><a href="#terminology"><span class=secno>2.1. </span>Терминология и соглашения</a>
    </ul>

   <li><a href="#interoperability"><span class=secno>3.
    </span>Вопросы интероперабельности</a>
    <ul class=toc>
     <li><a href="#extensibility"><span class=secno>3.1.
      </span>Расширяемость</a>
    </ul>

   <li><a href="#security"><span class=secno>4. </span>Вопросы безопасности</a>

   <li><a href="#privacy"><span class=secno>5. </span>Вопросы приватности
    </a>

   <li><a href="#the-apis"><span class=secno>6. </span>API</a>
    <ul class=toc>
     <li><a href="#interface-definitions"><span class=secno>6.1.
      </span>Определение интерфейсов</a>

     <li><a href="#findelements"><span class=secno>6.2. </span>Поиск элементов</a>

     <li><a href="#grammar"><span class=secno>6.3. </span>Грамматика</a>

     <li><a href="#processing-selectors"><span class=secno>6.4.
      </span>Обработка селекторов</a>

     <li><a href="#resolving-namespaces"><span class=secno>6.5.
      </span>Решение пространств имен</a>
    </ul>

   <li><a href="#examples0"><span class=secno>7. </span>Примеры</a>

   <li class=no-num><a href="#references">Ссылки</a>
    <ul class=toc>
     <li class=no-num><a href="#normative-references">Нормативные ссылки</a>

     <li class=no-num><a href="#informative-references">Информативные ссылки</a>
    </ul>

   <li class=no-num><a href="#acknowledgements">Благодарности</a>
  </ul>
  <!--end-toc-->

  <h2 id=introduction><span class=secno>1. </span>Введение</h2>

  <p><em>Этот раздел не является нормативным.</em>

  <p>Эта спецификация предоставляет методы для выбора и тестирования элементов
   в зависимости от того соответствуют ли они заданному селектору. С этими методами проще
   сопоставлять сет нод <a href="#element"><code>Element</code></a>
   основываясь на специальном критерии, чем в дальнейшем фильтровать результат вызова других методов, таких как <code>getElementsByTagName()</code>.

  <h3 id=examples><span class=secno>1.1. </span>Примеры</h3>

  <p><em>Этот раздел не является нормативным.</em>

  <p>Некоторые примеры на ECMAScript <a href="#ECMA-262-5.1"
   rel=biblioentry>[ECMA-262-5.1]<!--{{ECMA-262-5.1}}--></a>:

  <div class=example>
   <p>Этот пример таблицы написан на HTML 4.01.

   <pre>&lt;table id="score">
  &lt;thead>
    &lt;tr>
      &lt;th>Test
      &lt;th>Result
  &lt;tfoot>
    &lt;tr>
      &lt;th>Average
      &lt;td>82%
  &lt;tbody>
    &lt;tr>
      &lt;td>A
      &lt;td>87%
    &lt;tr>
      &lt;td>B
      &lt;td>78%
    &lt;tr>
      &lt;td>C
      &lt;td>81%
&lt;/table></pre>

   <p>Для того чтобы получить ячейки, содержащие результаты таблицы, что может
    быть сделано, к примеру, чтобы построить график значений, есть как
    минимум два подхода, которые можно использовать. Использование только API для DOM
    Level 2, это требует скрипт вроде следующего, который перебирает
    каждый <code>tr</code> внутри каждого <code>tbody</code> в
    <code>table</code>, чтобы найти вторую ячейку каждой строки.

   <pre>var table = document.getElementById("score");
var groups = table.tBodies;
var rows = null;
var cells = [];

for (var i = 0; i &lt; groups.length; i++) {
  rows = groups[i].rows;
  for (var j = 0; j &lt; rows.length; j++) {
    cells.push(rows[j].cells[1]);
  }
}</pre>

   <p>Второй метод это использование метода <code
    title=document-selectallelements>querySelectorAll()</code>, с которым скрипт становится намного более кратким.

   <pre>var cells = document.querySelectorAll("#score&gt;tbody&gt;tr&gt;td:nth-of-type(2)");</pre>

   <p>Заметьте, что скрипт работает на DOM, и работает независимо от
    синтаксиса используемого при создании документа. Таким образом, этот скрипт также будет правильно
    работать для такой же таблицы созданной в правильном XHTML вместо HTML, или динамически созданным и вставленным в документ с помощью DOM API.
  </div>

  <h2 id=conformance><span class=secno>2. </span>Требования к соответствию</h2>

  <p>Все диаграммы, примеры и заметки в данной спецификации не являются нормативными, также как все разделы помеченные не-нормативными.
   Все остальное в данном спецификации является нормативным.

  <p>Ключевые слова <em class=ct>must</em>, <em class=ct>must not</em>, <em
   class=ct>should</em>, <em class=ct>may</em> и <em
   class=ct>recommended</em> в нормативных частях этого документа должны интерпретироваться как описано в RFC 2119 <a href="#RFC2119"
   rel=biblioentry>[RFC2119]<!--{{!RFC2119}}--></a>.

  <p>Следующие классы соответствия определены (и рассматриваются) данной спецификацией:

  <dl>
   <dt><dfn id=conforming-user-agent>соответствующий агент пользователя</dfn>

   <dd>Агент пользователя реализующий интерфейсы описанные данной спецификацией и соответствует всем <em class=ct>must</em>-level критериям, которые применяются к реализациям.

   <dt><dfn id=conforming-application>соответствующее приложение</dfn>

   <dd>Приложение использующее интерфейсы описанные данной спецификацией
    и соответствующие всем <em class=ct>must</em>-level критериям, которые применяются к приложениям.
  </dl>

  <h3 id=terminology><span class=secno>2.1. </span>Терминология и соглашения</h3>

  <p>Терминология используемая в данной спецификации та же, что и в Селекторах <a
   href="#SELECT" rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a>.

  <p>Следующие функции определены в спецификации DOM Level 3 Core
   <a href="#DOM-LEVEL-3-CORE"
   rel=biblioentry>[DOM-LEVEL-3-CORE]<!--{{!DOM-LEVEL-3-CORE}}--></a>:

  <ul>
   <li><dfn id=document title=dom-document><code>Document</code></dfn>
    интерфейс.

   <li><dfn id=documentfragment><code>DocumentFragment</code></dfn>
    интерфейс.

   <li><dfn id=element><code>Element</code></dfn> интерфейс.

   <li><dfn id=nodelist><code>NodeList</code></dfn> интерфейс.
  </ul>

  <p>Требования соответствия выраженные в виде алгоритмов или конкретных шагов могут (<em
   class=ct>may</em>) быть реализованы любым способом, до тех пор пока конечный результат эквивалентен.

  <p>IDL используемый в этой спецификации использует синтаксис определенный в Web IDL <a
   href="#DOM-BINDINGS"
   rel=biblioentry>[DOM-BINDINGS]<!--{{!DOM-BINDINGS}}--></a>.

  <p>Конструкция "<code>Foo</code> объект", где <code>Foo</code> является интерфейсом, иногда используется вместо более точного
   "объект реализующий <code>Foo</code> интерфейс".

  <h2 id=interoperability><span class=secno>3. </span>Вопросы интероперабельности</h2>

  <p><em>Этот раздел не является нормативным.</em>

  <p>Некоторые реализации могут иметь разные уровни поддержки Селекторов. Если некоторым реализациям не хватает поддержки некоторых селекторов, то использование этих селекторов выдаст ошибку при возвращении ожидаемых результатов. Авторы советуют проверять исключения DOM
   выданные этими API и обеспечивать запасной вариант для плавной деградации.

  <h3 id=extensibility><span class=secno>3.1. </span>Расширяемость</h3>

  <p><em>Этот раздел не является нормативным.</em>

  <p>Расширения для API определены в этой спецификации <em>настоятельно нерекомендуемыми</em>. Реализаторы, Рабочие группы и прочие заинтересованные стороны должны обсуждать расширения на соответствующем публичном форуме, таком как <a
   href="mailto:public-webapps@w3.org">public-webapps@w3.org</a>.

  <h2 id=security><span class=secno>4. </span>Вопросы безопасности</h2>

  <p>Ожидается, что реализация данной спецификации не вводит новых рисков безопасности для пользователей.

  <p>Если, в любое время, реализация обнаруживает ситуацию которая может нарушить политику безопасности, реализация может (<em class=ct>may</em>) прервать действие и выдать ошибку безопасности. Если возникает любое другое условие ошибки, которое
   не покрывается напрямую этой или другой релевантной спецификацией, реализация может (<em class=ct>may</em>) прервать действие и выдать соответствующее исключение, основанное на особенностях языка или реализатора.

  <h2 id=privacy><span class=secno>5. </span>Вопросы приватности</h2>

  <p>Кража истории это потенциальная проблема приватности, потому что
   псевдо-класс <code>:visited</code> в Селекторах <a href="#SELECT"
   rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a> позволяет авторам запрашивать
   какие ссылки были посещены.

  <p class=note>Это не новая проблема, это уже может использоваться
   с помощью существующих CSS и DOM API, таких как <code>getComputedStyle()</code>
   <a href="#DOM-LEVEL-2-STYLE"
   rel=biblioentry>[DOM-LEVEL-2-STYLE]<!--{{DOM-LEVEL-2-STYLE}}--></a>.

  <div class=example>
   <p>В этом примере, <var>vlinks</var> получит список ссылок которые пользователь посетил. Затем автор может получить список URI и потенциально использовать это знание.

   <pre>var vlinks = document.querySelectorAll(":visited");
for (var i = 0; i &lt; vlinks.length; i++) {
  doSomethingEvil(vlinks[i].href);
}</pre>
  </div>

  <p>Как <a href="http://www.w3.org/TR/css3-selectors/#link">определено в
   <cite>Селекторах</cite></a> (<a href="#SELECT"
   rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a>, раздел 6.6.1), пользовательские агенты могут (<em class=ct>may</em>) обработать все ссылки как непосещенные ссылки. Рекомендуется (<em
   class=ct>recommended</em>), чтобы реализации вели себя стабильно с другими использованиями Селекторов поддерживаемыми агентом пользователя.

  <h2 id=the-apis><span class=secno>6. </span>API</h2>

  <p>Термин <dfn id=first>первый</dfn> используемый в определениях
   методов описанных этой спецификацией, означает <em>первый в порядке документа</em>. Термин <dfn id=document-order>порядок документа</dfn> означает поиск в глубину прямого порядка обхода дерева DOM или поддерева в вопросе.
   Термин <dfn id=context-node>контекстная нода</dfn> относится к ноде
   на которой метод был вызван. Термин <dfn id=subtrees>поддеревья</dfn>
   относится к набору элементов, которые являются потомками <a
   href="#context-node">контекстной ноды</a>. Термин <dfn
   id=matching-element-node>соответствующая <code>Element</code> нода</dfn> относится к <a href="#element"><code>Element</code></a> ноде которая соответствует <a
   href="#selector-string">строке селектора</a> (<var>selectors</var>) которая была передана методу, в соответствии с правилами соответствия элементов определенных Селекторами <a href="#SELECT"
   rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a>.

  <h3 id=interface-definitions><span class=secno>6.1. </span>Определение интерфейсов</h3>

  <pre class=idl>partial interface <a href="#document"
   title=dom-document>Document</a> {
  Element?  <a href="#queryselector"
   title=queryselector>querySelector</a>(DOMString selectors);
  NodeList  <a
   href="#queryselectorall"
   title=queryselectorall>querySelectorAll</a>(DOMString selectors);
};

partial interface <a
   href="#documentfragment">DocumentFragment</a> {
  Element?  <a
   href="#queryselector"
   title=queryselector>querySelector</a>(DOMString selectors);
  NodeList  <a
   href="#queryselectorall"
   title=queryselectorall>querySelectorAll</a>(DOMString selectors);
};

partial interface <a
   href="#element">Element</a> {
  Element?  <a href="#queryselector"
   title=queryselector>querySelector</a>(DOMString selectors);
  NodeList  <a
   href="#queryselectorall"
   title=queryselectorall>querySelectorAll</a>(DOMString selectors);
};
</pre>

  <h3 id=findelements><span class=secno>6.2. </span>Поиск элементов</h3>

  <p>Аргумент <var>selectors</var> для методов <a
   href="#queryselector"><code>querySelector</code></a> и <a
   href="#queryselectorall"><code>querySelectorAll</code></a> принимает <a href="#selector-string">строку селекторов</a>.

  <p>Методы <dfn id=queryselector
   title=queryselector><code>querySelector()</code></dfn> на интерфейсах <a
   href="#document"><code title=dom-document>Document</code></a>, <a
   href="#documentfragment"><code>DocumentFragment</code></a> и <a
   href="#element"><code>Element</code></a> должны (<em class=ct>must</em>)
   возвратить <a href="#first">первую</a> соответствующую <a
   href="#element"><code>Element</code></a> ноду в пределах <a
   href="#subtrees">поддеревьев</a> <a href="#context-node">контекстной ноды</a>. Если нет соответствующего <a
   href="#element"><code>Element</code></a>, метод должен (<em
   class=ct>must</em>) возвратить <code>null</code>.

  <p>Методы <dfn id=queryselectorall
   title=queryselectorall><code>querySelectorAll()</code></dfn> на интерфейсах <a href="#document"><code title=dom-document>Document</code></a>, <a
   href="#documentfragment"><code>DocumentFragment</code></a> и <a
   href="#element"><code>Element</code></a> должны (<em class=ct>must</em>)
   возвратить <a href="#nodelist"><code>NodeList</code></a> содержащий все соответствующие <a href="#element"><code>Element</code></a> ноды в пределах
   <a href="#subtrees">поддеревьев</a> <a href="#context-node">контекстной ноды</a>, в <a href="#document-order">порядке документа</a>. Если нет соответствующих нод, метод должен (<em class=ct>must</em>) вернуть пустой <a
   href="#nodelist"><code>NodeList</code></a>.

  <p>Когда вызван <a href="#queryselector"><code>querySelector</code></a> или
   <a href="#queryselectorall"><code>querySelectorAll</code></a>, реализация должна (<em class=ct>must</em>) следовать этим шагам:

  <ol>
   <li>
    <p>Сделать <var>parsed selector</var> результатом работы алгоритма <a href="#parse-a-selector">обработки селектора</a> с
     <var>selectors</var> в качестве входного.

   <li>
    <p>Реализация должна затем запустить алгоритм <a
     href="#evaluate-a-selector">оценки селектора</a> к нодам элемента в заданном <span title=concept-tree>дереве</span> или <a
     href="#subtrees">поддеревьях</a>, используя <var>parsed selector</var> как селектор для возвращения необходимого результата вызванного метода.
  </ol>

  <p>Объект <a href="#nodelist"><code>NodeList</code></a> возвращенный методом
   <code>querySelectorAll()</code>, должен (<em class=ct>must</em>) быть статичным,
   а не <a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#td-live"
   title="Document Object Model Core">живым</a> (<a href="#DOM-LEVEL-3-CORE"
   rel=biblioentry>[DOM-LEVEL-3-CORE]<!--{{!DOM-LEVEL-3-CORE}}--></a>,
   раздел 1.1.1). Последующие изменения в структуре базового документа не должны (<em class=ct>must not</em>) затрагиваться в объекте <a
   href="#nodelist"><code>NodeList</code></a>. Это означает, что объект будет содержать список соответствующих <a
   href="#element"><code>Element</code></a> нод, которые были в документе на момент создания списка.

  <h3 id=grammar><span class=secno>6.3. </span>Грамматика</h3>

  <p><dfn id=selector-string>Строка селектора</dfn> это список из одной или более
   <a href="http://dev.w3.org/csswg/selectors4/#complex">групп селекторов</a> (<a href="#SELECT"
   rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a>, раздел 5), которые могут (<em
   class=ct>may</em>) быть окружены пробелами и соответствовать
   <code>dom_selectors_group</code>.

  <pre>
dom_selectors_group
  : S* [ selectors_group ] S*
  ;
</pre>

  <p>Грамматика для <code>selectors_group</code> определена в Selectors
   Level 3 (<a href="#SELECT" rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a>,
   раздел 10.1). Эти группы селекторов не должны (<em class=ct>should not</em>) использовать
   <a href="#namespace-prefix-needs-to-be-resolved"
   title=need-to-resolve>префиксы пространств имен которые должны быть разрешены</a>.

  <p class=note>Реализаторам советуется, что если значение <code>null</code> или
   <code>undefined</code> передано как значение параметра <var>selectors</var>, оно должно быть обработано как описано в WebIDL <a
   href="#DOM-BINDINGS"
   rel=biblioentry>[DOM-BINDINGS]<!--{{!DOM-BINDINGS}}--></a>. Авторы советуют избегать передачи этих значений.

  <p class=note>В то время как использование псевдо-элементов в селекторах допускается, они не будут соответствовать каким-либо элементам в документе, и поэтому не приводят в возвращению элементов. Поэтому
   авторы советуют избегать использования псевдо-элементов в селекторах которые
   передаются к методам описанным в этой спецификации.

  <h3 id=processing-selectors><span class=secno>6.4. </span>Обработка селекторов</h3>

  <p>Шаги для <dfn id=parse-a-selector>обработки селектора</dfn> являются следующими:

  <ol>
   <li>
    <p>Сделать <var>selectors</var> <a href="#selector-string">строкой селектора</a> введенной в этот алгоритм.

   <li>
    <p>Сделать <var>result</var> группой селекторов возвращенных как результат
     обработки <var>selectors</var> согласно грамматике для
     <code>dom_selectors_group</code> описанной выше.

   <li>
    <p>Если <var>result</var> является <a
     href="http://www.w3.org/TR/css3-selectors/#Conformance">не валидным</a> (<a
     href="#SELECT" rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a>, раздел
     12), <a
     href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMException-SYNTAX_ERR">выдать исключение <code>SYNTAX_ERR</code></a> (<a href="#DOM-LEVEL-3-CORE"
     rel=biblioentry>[DOM-LEVEL-3-CORE]<!--{{!DOM-LEVEL-3-CORE}}--></a>,
     раздел 1.4) и прервать этот алгоритм.

   <li>Возвратить <var>result</var>.
  </ol>

  <p>Шаги для <dfn id=evaluate-a-selector>оценки селектора</dfn> являются следующими:

  <ol>
   <li>
    <p>Сделать <var title="">element</var> оцениваемым элементом.

   <li>
    <p>Сделать <var>selector group</var> входящим значением селекторов в этот алгоритм.

   <li>
    <p>Если любой селектор в <var>selector group</var> соответствует <var
     title="">element</var>, возвратить true. В другом случае, возвратить false.
  </ol>

  <p>Селекторы оцениваются к заданному элементу в контексте всего
   дерева DOM в котором элемент находится.

  <p>Если пользовательский агент также поддерживает какой-то уровень CSS, реализация должна
   (<em class=ct>should</em>) поддерживать тот же набор селекторов вместе с этими API и CSS.

  <h3 id=resolving-namespaces><span class=secno>6.5. </span>Решение пространств имен</h3>

  <p>Если группа селекторов включает <a
   href="#namespace-prefix-needs-to-be-resolved"
   title=need-to-resolve>префиксы пространств имен которые должны быть решены</a>, реализация должна (<em class=ct>must</em>) <a
   href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMException-SYNTAX_ERR">выдать 
   исключение <code>SYNTAX_ERR</code></a> (<a href="#DOM-LEVEL-3-CORE"
   rel=biblioentry>[DOM-LEVEL-3-CORE]<!--{{!DOM-LEVEL-3-CORE}}--></a>,
   раздел 1.4).

  <p class=note>Эта спецификация не предоставляет поддержки для решения
   произвольных префиксов пространств имен. Однако, поддержка механизма разрешения 
   префиксов пространств имен может быть рассмотрена для включения в будущую версию этой спецификации.

  <p><dfn id=namespace-prefix-needs-to-be-resolved
   title=need-to-resolve>Префиксы пространств имен должны быть разрешены</dfn> если компонент пространства имен не является ни пустым (например <code>|div</code>),
   представляющим null пространство имен, либо звездочку (например <code>*|div</code>),
   представляющую любое пространство имен. Так как звездочка или пустой префикс пространств имен
   не требует разрешения, реализации которые поддерживают синтаксис пространства имен в Селекторах, должны (<em class=ct>must</em>) поддерживать их. <a
   href="#SELECT" rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a>

  <h2 id=examples0><span class=secno>7. </span>Примеры</h2>

  <div class=example>
   <p>Следующие примеры используют образец этого XHTML документа.

   <pre>&lt;html xmlns="http://www.w3.org/1999/xhtml">
  &lt;head>
    &lt;title&gt;Selectors API Example&lt;/title&gt;
  &lt;/head>
  &lt;body>
    &lt;div id="foo"&gt;
      &lt;p class="warning"&gt;This is a sample warning&lt;/p&gt;
      &lt;p class="error"&gt;This is a sample error&lt;/p&gt;
    &lt;/div&gt;
    &lt;div id="bar"&gt;
      &lt;p&gt;...&lt;/p&gt;
    &lt;/div&gt;
  &lt;/body>
&lt;/html></pre>

   <p>Методы принимают группы селекторов (разделенные запятой) в качестве аргумента. Следующий пример выберет все элементы <code>p</code> в документе, которые имеют класс "<code>error</code>" или "<code>warning</code>".

   <pre>var alerts = document.querySelectorAll("p.warning, p.error");</pre>

   <p>Методы <code title=document-selectelement>querySelector()</code> также принимают группу селекторов и они вернут первый элемент
    (если есть), который соответствует любому селектору в группе.

   <pre>var x = document.querySelector("#foo, #bar");</pre>

   <p><var>x</var> будет содержать первый элемент в документе с ID
    <code>foo</code> или <code>bar</code>, или <code>null</code> если нет такого элемента. В простом документе выше, он выберет элемент <code>div</code> с ID <code>foo</code>, потому что он первый в <a href="#document-order">порядке документа</a>. Порядок селекторов используемый в параметрах не имеет эффекта и будет давать тот же результат при перестановке порядка, как в:

   <pre>var x = document.querySelector("#bar, #foo");</pre>

   <p>Методы также могут быть вызваны на элементах. В следующем примере,
    предположим, обработчик события регистрируется на элементе, и таким образом
    метод вызывается на целевом элементе события.

   <pre>function handle(evt) {
  var x = evt.target.querySelector("span");
  ...
  // Сделать что-то с x
}</pre>

   <p>Даже при том что метод вызван на элементе, селекторы все еще
    оцениваются в контексте всего документа. В следующем примере, метод будет по-прежнему соответствовать потомку <code>div</code> элемента,
    элементу <code>p</code>, хотя элемент <code>body</code> не является потомком элемента <code>div</code>.

   <pre>var div = document.getElementById("bar");
var p = div.querySelector("body p");</pre>

   <p>Возьмем в качестве примера этот фрагмент, который содержит список как меню навигации:

   <pre>&lt;ul class="nav"&gt;
  &lt;li&gt;&lt;a href="/"&gt;Home&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href="/products"&gt;Products&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href="/about"&gt;About&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</pre>

   <p>Следующий пример выберет все элементы <code>li</code> и
    покажет как перебираются наборы в <a
    href="#nodelist"><code>NodeList</code></a>.

   <pre>var lis = document.querySelectorAll("ul.nav&gt;li");
for (var i = 0; i &lt; lis.length; i++) {
  process(lis.item(i));
}</pre>

   <p>В ECMAScript связывание языка также позволяет <a
    href="#nodelist"><code>NodeList</code></a>-ам рассматриваться с помощью
    обозначения массива, так что цикл может быть переписан таким образом:

   <pre>for (var i = 0; i &lt; lis.length; i++) {
  process(lis[i]);
}</pre>

   <p>Так как объекты <a href="#nodelist"><code>NodeList</code></a> возвращаемые этими методами не живые, изменения в DOM не затрагивают содержание списка. Рассмотрим функцию <code>process()</code>, названную в предыдущих примерах, определенную как:

   <pre>function process(elmt) {
  elmt.parentNode.removeChild(elmt);
}</pre>

   <p>Это вызовет удаление каждого выбранного элемента из DOM, но каждый элемент будет оставаться в <a
    href="#nodelist"><code>NodeList</code></a>. Если бы список был живым <a
    href="#nodelist"><code>NodeList</code></a>, удаление элемента из DOM
    также бы удалило элемент из списка и скорректировало бы показатели последующих элементов. Это бы негативно повлияло на цикл,
    потому что не все выбранные элементы были бы обработаны.

   <p>В документах содержащих элементы с многими пространствами имен, некоторые элементы с разными пространствами имен могут разделять одно локальное имя. Так как этот API изначально не поддерживает механизм разрешения пространств имен для селекторов, получение списка таких элементов из определенного пространства имен, исключая все остальные, требует дополнительной обработки для фильтрации результата. Следующий пример иллюстрирует документ содержащий элементы <code>video</code> с пространствами имен SVG и XHTML.

   <pre>&lt;svg id=&quot;svg1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;
               xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;
  &lt;video id=&quot;svgvideo1&quot; xlink:href=&quot;myvideo.ogg&quot; width=&quot;320&quot; height=&quot;240&quot;/&gt;
  &lt;foreignObject width=&quot;100&quot; height=&quot;100&quot;&gt;
    &lt;video id=&quot;htmlvideo1&quot; src=&quot;myvideo.ogg&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;No video1&lt;/video&gt;
  &lt;/foreignObject&gt;
&lt;/svg&gt;</pre>

   <p>Следующий скрипт демонстрирует как выбрать элементы
    <code>video</code> и затем отфильтровать нежелательные элементы, основываясь на их пространстве имен.

   <pre>var elms = document.querySelectorAll("svg video");
var result = new Array();
var svgns = "http://www.w3.org/2000/svg"

for(var i = 0; i &lt; elms.length; i++) {
  if(elms[i].namespaceURI == svgns) {
    result.push(elms[i]);
  }
}</pre>
  </div>

  <h2 class=no-num id=references>Ссылки</h2>

  <h3 class=no-num id=normative-references>Нормативные ссылки</h3>
  <!--begin-normative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->

   <dt id=DOM-BINDINGS>[DOM-BINDINGS]

   <dd>Cameron McCormack. <a
    href="http://www.w3.org/TR/2012/CR-WebIDL-20120419/"><cite>Web
    IDL.</cite></a> 19 апреля 2012. Кандидат в Рекомендации W3C. (Работа в процессе). URL: <a
    href="http://www.w3.org/TR/2012/CR-WebIDL-20120419/">http://www.w3.org/TR/2012/CR-WebIDL-20120419/</a>
   </dd>
   <!---->

   <dt id=DOM-LEVEL-3-CORE>[DOM-LEVEL-3-CORE]

   <dd>Gavin Nicol; и соавторы. <a
    href="http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407"><cite>Document
    Object Model (DOM) Level 3 Core Specification.</cite></a> 7 апреля 2004.
    Рекомендация W3C. URL: <a
    href="http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407">http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407</a>
   </dd>
   <!---->

   <dt id=RFC2119>[RFC2119]

   <dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key
    words for use in RFCs to Indicate Requirement Levels.</cite></a> Internet
    RFC 2119. URL: <a
    href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a>
   </dd>
   <!---->

   <dt id=SELECT>[SELECT]

   <dd>Tantek Çelik; и соавторы. <a
    href="http://www.w3.org/TR/2011/REC-css3-selectors-20110929/"><cite>Selectors
    Level 3.</cite></a> 29 сентября 2011. Рекомендация W3C. URL: <a
    href="http://www.w3.org/TR/2011/REC-css3-selectors-20110929/">http://www.w3.org/TR/2011/REC-css3-selectors-20110929/</a>
   </dd>
   <!---->
  </dl>
  <!--end-normative-->

  <h3 class=no-num id=informative-references>Информативные ссылки</h3>
  <!--begin-informative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->

   <dt id=CSS21>[CSS21]

   <dd>Bert Bos; и соавторы. <a
    href="http://www.w3.org/TR/2011/REC-CSS2-20110607/"><cite>Cascading Style
    Sheets Level 2 Revision 1 (CSS 2.1) Specification.</cite></a> 7 июня
    2011. Рекомендация W3C. URL: <a
    href="http://www.w3.org/TR/2011/REC-CSS2-20110607/">http://www.w3.org/TR/2011/REC-CSS2-20110607/</a>
   </dd>
   <!---->

   <dt id=DOM-LEVEL-2-STYLE>[DOM-LEVEL-2-STYLE]

   <dd>Chris Wilson; Philippe Le Hégaret; Vidur Apparao. <a
    href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/"><cite>Document
    Object Model (DOM) Level 2 Style Specification.</cite></a> 13 ноября
    2000. Рекомендация W3C. URL: <a
    href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/">http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/</a>
   </dd>
   <!---->

   <dt id=ECMA-262-5.1>[ECMA-262-5.1]

   <dd><a
    href="http://www.ecma-international.org/publications/standards/Ecma-262.htm"><cite>ECMAScript
    Language Specification, Edition 5.1.</cite></a> Июнь 2011. ISO/IEC
    16262:2011. URL: <a
    href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">http://www.ecma-international.org/publications/standards/Ecma-262.htm</a>
   </dd>
   <!---->
  </dl>
  <!--end-informative-->

  <h2 class=no-num id=acknowledgements>Благодарности</h2>

  <p>Редакторы хотели бы поблагодарить следующих людей, которые
   внесли свой вклад в эту спецификацию (упорядочены по имени):

  <p>Adam van den Hoven, Alan Gresley, Alex Russell, Arthur Barstow, Aryeh
   Gregor, Björn Höhrmann, Boris Zbarsky, Cameron McCormack, Charles
   McCathieNevile, Chris Wilson, Christophe Jolif, Daniel Glazman, Daniel
   Schierbeck, Dave Massy, David "liorean" Andersson, David Greenspan, David
   Håsäther, Dean Jackson, Doug Schepers, Erik Dahlström, Francois Remy,
   Hallvord R. M. Steen, Henri Sivonen, Ian Hickson, Ivan Enderlin, Jean-Yves
   Bitterlich, Jim Ley, João Eiras, John Resig, Jon Ferraiolo, Jonas
   Sicking, Jorgen Horstink, Kang-Hao (Kenny) Lu, Karl Dubost, Kartikaya
   Gupta, L. David Baron, Maciej Stachowiak, Magnus Kristiansen, Marat
   Tanalin, Martijn, Masataka Yakura, Mihai Sucan, Mohamed Zergaoui, Nicholas
   C. Zakas, Nicolas Mendoza, Norbert Lindenberg, Philip Taylor, Robert
   Sayre, Robin Berjon, Sander, Sergey Ilinsky, Simon Pieters, Steven
   Pemberton, Stewart Brodie Tab Atkins Jr., Tarquin Wilton-Jones, Travis
   Leithead, и William J. Edney

  <p>Особое спасибо John Resig и Øyvind Stenhaug за их значительный
   вклад в серии тестов.

  <p>Спасибо всем тем, кто помог улучшить эту спецификацию, присылая предложения и исправления.

